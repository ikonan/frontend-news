# æœ€ä½³å®è·µï¼šåˆ›å»ºä¸€ä¸ªå®‰å…¨çš„ç°ä»£ npm åŒ…

æŠ€æœ¯ä¸æ–­å‘å±•ï¼Œä½ çš„æµç¨‹å’Œå®è·µä¹Ÿéœ€è¦ä¸æ—¶ä¿±è¿›ã€‚è™½ç„¶ npm åˆ° 2025 å¹´å·²æœ‰ 15 å¹´å†å²ï¼Œä½† ==ä½ åˆ›å»º npm åŒ…çš„æ–¹å¼åº”è¯¥æ›´åŠ ç°ä»£åŒ–==ã€‚å¦‚æœä½ è§‰å¾—è‡ªå·±çš„æ–¹æ³•å¯èƒ½æœ‰äº›è¿‡æ—¶ï¼Œè¯·ç»§ç»­é˜…è¯»ã€‚

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†é€æ­¥ä»‹ç»å¦‚ä½•ä½¿ç”¨ 2025 å¹´çš„ç°ä»£æœ€ä½³å®è·µæ¥åˆ›å»º npm åŒ…ã€‚é¦–å…ˆä½ å°†å­¦ä¹ å¦‚ä½•åˆ›å»º npm åŒ…ï¼Œç†Ÿæ‚‰æ„å»ºå’Œå‘å¸ƒåŒ…åˆ° npm æ³¨å†Œè¡¨çš„æµç¨‹ã€‚æ¥ç€ä½ å°†äº†è§£å¦‚ä½•é€šè¿‡è®¾ç½®æµ‹è¯•æ¡†æ¶ã€æŒç»­é›†æˆå’Œéƒ¨ç½²æµæ°´çº¿ã€å®‰å…¨æ£€æŸ¥ä»¥åŠè‡ªåŠ¨åŒ–çš„è¯­ä¹‰ç‰ˆæœ¬ç®¡ç†æ¥æ‰“é€  ==æ›´å¥å£®ä¸”å¯ç”¨äºç”Ÿäº§ç¯å¢ƒçš„ npm åŒ…==ã€‚å­¦å®Œæœ¬æ•™ç¨‹åï¼Œä½ å°†èƒ½å¤Ÿè‡ªä¿¡åœ°åˆ›å»ºç°ä»£åŒ–ä¸”å¯æŒç»­ç»´æŠ¤çš„ npm åŒ…ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ï¼

## å…ˆå†³æ¡ä»¶

1. ç†Ÿæ‚‰ Node.jsã€JavaScript/TypeScriptã€GitHub å’Œ GitHub Actions
2. å…·å¤‡ååŠ©åˆ›å»º npm åŒ…çš„å¼€å‘å·¥å…·

## ç®€å•ç¤ºä¾‹ npm åŒ…

é¦–å…ˆé€šè¿‡ä¸€ä¸ªç®€å•ç¤ºä¾‹æ¥ç†Ÿæ‚‰åˆ›å»ºå’Œå‘å¸ƒ npm åŒ…çš„æµç¨‹ã€‚å¦‚æœä½ å·²ç»ç†Ÿæ‚‰è¿™äº›å†…å®¹ï¼Œå¯ä»¥ç›´æ¥è·³è½¬åˆ°[ç”Ÿäº§å°±ç»ªçš„ npm åŒ…](https://snyk.io/blog/best-practices-create-modern-npm-package/#npm-package)éƒ¨åˆ†ï¼Œè¯¥éƒ¨åˆ†æ¶µç›–æ›´é«˜çº§çš„ä¸»é¢˜ã€‚

### è®¾ç½®ä½ çš„é¡¹ç›®

ä½ éœ€è¦ä¸€ä¸ª GitHub é¡¹ç›®æ¥å¼€å§‹ï¼Œæ‰€ä»¥è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ¥åˆå§‹åŒ–é¡¹ç›®ã€‚å¦‚æœä½ å·²ç»æœ‰ä¸€ä¸ªå¯ç”¨çš„é¡¹ç›®ï¼Œå¯ä»¥è·³è¿‡ä¸‹ä¸€èŠ‚ï¼Œä½† ==è¯·åŠ¡å¿…ä»”ç»†æ£€æŸ¥æœ¬èŠ‚ä¸­çš„ç¬¬ 5 æ­¥== å…³äºä½ çš„åŒ…åç§°ã€‚

- åˆ›å»ºä¸€ä¸ª GitHub ä»“åº“ï¼š[https://github.com/new](https://github.com/new)  
- å°†ä»“åº“å…‹éš†åˆ°æœ¬åœ°ã€‚  
    **ç¤ºä¾‹ï¼š** `git clone` [https://github.com/snyk-snippets/simple-npm-package.git](https://github.com/snyk-snippets/simple-npm-package.git)
- æ‰“å¼€ç»ˆç«¯å¹¶åˆ‡æ¢åˆ°å…‹éš†é¡¹ç›®çš„æ–‡ä»¶å¤¹ã€‚  
    **ç¤ºä¾‹ï¼š** `cd simple-npm-package`
- è¿è¡Œ `npm init -y` æ¥åˆ›å»º `package.json` æ–‡ä»¶ã€‚**æ³¨æ„ï¼š** å¦‚æœä½ å…‹éš†äº†ç¤ºä¾‹ä»“åº“ï¼Œåˆ™ä¸éœ€è¦æ‰§è¡Œæ­¤æ­¥éª¤ã€‚
- ä½¿ç”¨ä½œç”¨åŸŸåç§°æ›´æ–° `package.json` ä¸­çš„ `name` å±æ€§ã€‚  
    **ç¤ºä¾‹ï¼š** `@clarkio/simple-npm-package`ã€‚è¯·ç¡®ä¿ä½¿ç”¨ä½ çš„ç”¨æˆ·åæˆ–ç»„ç»‡åç§°è€Œä¸æ˜¯ `@clarkio`ã€‚
- ä¸ºåŒ…ç¼–å†™ä»£ç ï¼ˆæˆ–ç›´æ¥ä½¿ç”¨ index.js ä¸­çš„ hello world ç¤ºä¾‹ï¼‰ã€‚

é¡¹ç›®åˆ›å»ºå®Œæˆåï¼Œä½ å¯ä»¥ç»§ç»­åˆ›å»º npm è´¦æˆ·ã€‚

### è®¾ç½® npm è´¦æˆ·

ä¸ºäº†è®©å…¶ä»–äººèƒ½å¤Ÿä½¿ç”¨ä½ çš„ npm åŒ…ï¼Œä½ éœ€è¦ä¸€ä¸ª npm è´¦æˆ·ã€‚ä»¥ä¸‹æ­¥éª¤å°†æŒ‡å¯¼ä½ åˆ›å»ºè‡ªå·±çš„è´¦æˆ·ï¼ˆå¦‚æœä½ è¿˜æ²¡æœ‰ï¼‰ï¼Œå¯ç”¨åŒé‡èº«ä»½éªŒè¯ï¼ˆ2FAï¼‰ä»¥æé«˜è´¦æˆ·å®‰å…¨æ€§ï¼Œå¹¶å°†è´¦æˆ·è¿æ¥åˆ°æœ¬åœ°æœºå™¨ã€‚

1\. åœ¨ [https://www.npmjs.com/signup](https://www.npmjs.com/signup) æ³¨å†Œ npm è´¦æˆ·ã€‚

2\. ä¸ºäº†æ›´å¥½çš„å®‰å…¨æ€§ï¼Œåœ¨ npm è´¦æˆ·ä¸Šå¯ç”¨ 2FAï¼š[https://docs.npmjs.com/configuring-two-factor-authentication](https://docs.npmjs.com/configuring-two-factor-authentication)ã€‚

3\. åœ¨ç»ˆç«¯ä½¿ç”¨ `npm login` å‘½ä»¤ç™»å½•ä½ çš„ npm è´¦æˆ·ï¼Œå¹¶æŒ‰ç…§å±å¹•ä¸Šçš„æŒ‡ç¤ºæ“ä½œã€‚ä¾‹å¦‚ï¼š

```javascript
> npm login 
npm notice Log in on https://registry.npmjs.org/ 
Username: clarkio 
Password: 
Email: (this IS public) <email address> 
npm notice Please use the one-time password (OTP) from your authenticator application 
Enter one-time password from our authenticator app: <OTP> 
Logged in as clarkio on https://registry.npmjs.org/.
```

### å¦‚ä½•å‘å¸ƒä½ çš„ npm åŒ…

å½“ä½ æ‹¥æœ‰ npm é¡¹ç›®å¹¶æ³¨å†Œäº† npm è´¦æˆ·åï¼Œå°±å¯ä»¥å°†åŒ…å‘å¸ƒåˆ° [å®˜æ–¹ npm å…¬å…±æ³¨å†Œè¡¨](https://npmjs.org/)ã€‚ä»¥ä¸‹æ˜¯å‘å¸ƒå‰æ£€æŸ¥ä¸æ­£å¼å‘å¸ƒçš„å®Œæ•´æµç¨‹ï¼š

1\. åœ¨ç»ˆç«¯è¿è¡Œ `npx pack --dry-run` é¢„è§ˆå°†è¦å‘å¸ƒçš„åŒ…å†…å®¹ï¼š

```bash
> npx pack --dry-run 
npm notice Tarball Contents 
npm notice 1.1kB LICENSE 
npm notice 1.9kB README.md 
npm notice 108B index.js 
npm notice 700B package.json 
npm notice Tarball Details
```

è¿™å¯ç¡®ä¿ä½ æ²¡æœ‰é—æ¼ä»»ä½•åŒ…æ­£å¸¸è¿è¡Œæ‰€éœ€çš„æºä»£ç æ–‡ä»¶ã€‚å¦å¤–ï¼Œç¡®ä¿ä¸ä¼šæ„å¤–åœ°å‘å…¬ä¼—æ³„éœ²æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚åŒ…å«æ•°æ®åº“å‡­è¯æˆ– API å¯†é’¥çš„æœ¬åœ°é…ç½®æ–‡ä»¶ï¼‰ä¹Ÿæ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚

2\. åœ¨ç»ˆç«¯ä¸­è¿è¡Œ `npm publish --dry-run` å‘½ä»¤ï¼Œä»¥æŸ¥çœ‹å®é™…æ‰§è¡Œè¯¥å‘½ä»¤æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

```bash
> npm publish --dry-run 
npm notice 
npm notice ğŸ“¦@clarkio/simple-npm-package@0.0.1 
npm notice === Tarball Contents === 
npm notice 1.1kB LICENSE 
npm notice 1.2kB README.md 
npm notice 95B index.js 
npm notice 690B package.json 
npm notice === Tarball Details=== 
npm notice name: @clarkio/simple-npm-package 
npm notice version: 0.0.1 
npm notice filename:@clarkio/simple-npm-package-0.0.1.tgz 
npm notice package size:1.7 kB 
npm notice unpacked size: 3.1 kB 15npm notice shasum:40ede3ed630fa8857c0c9b8d4c81664374aa811c 
npm notice integrity:sha512-QZCyWZTspkcUXL... ]L60ZKBOOBRLTg== 
npm notice total files:4 
npm notice 
+ @clarkio/simple-npm-package@0.0.1
```

3\. åœ¨ç»ˆç«¯ä¸­è¿è¡Œ `npm publish --access=public` ä»¥å°†åŒ…å®é™…å‘å¸ƒåˆ° npmã€‚**æ³¨æ„**ï¼šä½œç”¨åŸŸåŒ…ï¼ˆå¦‚ @clarkio/modern-npm-packageï¼‰é»˜è®¤æ˜¯ç§æœ‰çš„ï¼Œå› æ­¤éœ€è¦ `--access=public` é€‰é¡¹ã€‚å¦‚æœåŒ…æ²¡æœ‰ä½œç”¨åŸŸï¼Œå¹¶ä¸” `package.json` ä¸­çš„ `private` å­—æ®µæœªè®¾ç½®ä¸º `true`ï¼Œåˆ™è¯¥åŒ…ä¹Ÿå°†æ˜¯å…¬å¼€çš„ã€‚

```bash
> npm publish --access=public 
npm notice 
npm notice ğŸ“¦@clarkio/simple-npm-package@0.0.1 
npm notice === Tarball Contents === 
npm notice 1.1kB LICENSE 
npm notice 1.2kB README.md 
npm notice 95B index.js 
npm notice 690B package.json 
npm notice === Tarball Details=== 
npm notice name: @clarkio/simple-npm-package 
npm notice version: 0.0.1 
npm notice filename:@clarkio/simple-npm-package-0.0.1.tgz 
npm notice package size:2.1 kB 
npm notice unpacked size: 4.1 kB 
npm notice shasum:6f335d6254ebb77a5a24ee729650052a69994594 
npm notice integrity:sha512-VZ1K1eMFOKeJW[...]7ZjKFVAxLcpdQ== 
npm notice total files:4 
npm notice 
This operation requires a one-time password. 
Enter OTP: <OTP> 
+ @clarkio/simple-npm-package@0.0.1
```

ä½ å·²ç»å®Œæˆäº†ï¼ä½ å·²ç»æ„å»ºå¹¶éƒ¨ç½²äº†è‡ªå·±çš„ npm åŒ…ã€‚æ¥ä¸‹æ¥ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ›´å¥å£®çš„ã€å¯ç”¨äºç”Ÿäº§ç¯å¢ƒä¸”èƒ½è¢«æ›´å¹¿æ³›ä½¿ç”¨çš„åŒ…ã€‚

## ç”Ÿäº§å°±ç»ªçš„ npm åŒ…

è™½ç„¶ä¹‹å‰çš„ç¤ºä¾‹åŒ…æœ‰å¯èƒ½åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œä½†éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå®ƒéœ€è¦æ‰‹åŠ¨ç»´æŠ¤ã€‚ä½¿ç”¨å·¥å…·å’Œè‡ªåŠ¨åŒ–ï¼Œç»“åˆé€‚å½“çš„æµ‹è¯•å’Œå®‰å…¨æ£€æŸ¥ï¼Œå°†æœ‰åŠ©äºå‡å°‘ä¿æŒåŒ…å¹³ç¨³è¿è¡Œæ‰€éœ€çš„æ€»ä½“å·¥ä½œé‡ã€‚è®©æˆ‘ä»¬æ·±å…¥äº†è§£è¿™æ¶‰åŠå“ªäº›æ–¹é¢ã€‚

ä»¥ä¸‹éƒ¨åˆ†å°†æ¶µç›–ï¼š

1. è®¾ç½®ä½ çš„ `modern-npm-package` é¡¹ç›®

2. ä¸º ECMAScript (ESM) æ¨¡å—æ ¼å¼è¿›è¡Œæ„å»º

3. è®¾ç½®å¹¶ç¼–å†™å•å…ƒæµ‹è¯•

4. å®æ–½å®‰å…¨æ£€æŸ¥

5. è‡ªåŠ¨åŒ–ç‰ˆæœ¬ç®¡ç†å’Œå‘å¸ƒ

å¦‚æœä½ åœ¨é˜…è¯»æœ¬æ–‡æ—¶æ²¡æœ‰è‡ªå·±çš„é¡¹ç›®å¯ä»¥ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹ç¤ºä¾‹é¡¹ç›®ï¼š[https://github.com/snyk-snippets/modern-npm-package](https://github.com/snyk-snippets/modern-npm-package)ã€‚

### ä¸º ECMAScript æ¨¡å—æ ¼å¼è¿›è¡Œæ„å»º

ä» Node.js 12 ç‰ˆæœ¬åŠæ›´é«˜ç‰ˆæœ¬å¼€å§‹ï¼ŒECMAScript æ¨¡å—æ ¼å¼å·²å¾—åˆ°åŸç”Ÿæ”¯æŒï¼Œæœ€æ–°çš„é•¿æœŸæ”¯æŒç‰ˆæœ¬æ˜¯ 22.xã€‚æ­¤å¤–ï¼ŒJavaScript è¿è¡Œæ—¶é¢†åŸŸä¹Ÿæœ‰äº†æ›´å¤šç«äº‰å¯¹æ‰‹ï¼Œå¦‚ Bun.js å’Œ Denoï¼Œè¿™äº›éƒ½ä½¿å¾—ç°åœ¨ä¸“æ³¨äºä½¿ç”¨ ESM æ ¼å¼å˜å¾—æ›´åŠ å®¹æ˜“ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ TypeScript æ¥è®©ä½ çš„ npm åŒ…æ”¯æŒ ESM æ ¼å¼ã€‚

- é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåä¸º `tsconfig.json` çš„ TypeScript é…ç½®æ–‡ä»¶ã€‚è¿™æ˜¯ç”¨äºåœ¨ä½¿ç”¨ ESM æ„å»ºä½ çš„åŒ…æ—¶å¯ä½¿ç”¨çš„ç¼–è¯‘è®¾ç½®ã€‚ä½ å¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚éšæ„è°ƒæ•´æ­¤æ–‡ä»¶ï¼Œç‰¹åˆ«æ˜¯å¦‚æœä½ ä¸ä½¿ç”¨æä¾›çš„ç¤ºä¾‹é¡¹ç›®ç»“æ„ï¼Œä½ éœ€è¦è°ƒæ•´ `files` å±æ€§ä»¥ä¸ä½ çš„é¡¹ç›®ç»“æ„ä¿æŒä¸€è‡´ã€‚

```json
{
  "compilerOptions": {
    "lib": ["ES2024", "DOM"],
    "target": "ES2024",
    "module": "NodeNext",
    "moduleResolution": "NodeNext",
    "outDir": "./lib/",
    "declarationDir": "./lib/types",
    "strict": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "skipLibCheck": true,
    "checkJs": true,
    "allowJs": true,
    "declaration": true,
    "declarationMap": true,
    "allowSyntheticDefaultImports": true
  },
  "files": ["./src/index.ts"]
}

```

- `lib` å±æ€§å‘ TypeScript æŒ‡æ˜åœ¨ä¸ºé¡¹ç›®ç¼–å†™ä»£ç æ—¶åº”å¼•ç”¨å“ªäº›ç±»å‹ä»¥æä¾›å¸®åŠ©ã€‚
- `target` å±æ€§å‘ TypeScript æŒ‡æ˜åº”å°†é¡¹ç›®ä»£ç ç¼–è¯‘æˆå“ªä¸ª JavaScript ç‰ˆæœ¬ã€‚
- `module` å±æ€§å‘ TypeScript æŒ‡æ˜åœ¨ç¼–è¯‘é¡¹ç›®ä»£ç æ—¶åº”ä½¿ç”¨å“ªç§ JavaScript æ¨¡å—æ ¼å¼ã€‚
- `moduleResolution` å±æ€§å¸®åŠ© TypeScript ç¡®å®šå¦‚ä½•å¼•ç”¨ â€œimportâ€ è¯­å¥ã€‚
- `outDir` å’Œ `declarationDir` å±æ€§å‘ TypeScript æŒ‡æ˜åº”å°†ç¼–è¯‘ä»£ç çš„ç»“æœä»¥åŠå®šä¹‰å…¶ä¸­ä½¿ç”¨çš„ç±»å‹çš„æ–‡ä»¶æ”¾ç½®åœ¨ä½•å¤„ã€‚

2\. æ›´æ–° `package.json` æ–‡ä»¶ï¼Œæ·»åŠ ä¸€ä¸ª `files` å­—æ®µï¼Œè¯¥å­—æ®µæŒ‡å‘ `lib` æ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶å¤¹åŒ…å« TypeScript ä¸ºä½ æ„å»ºåŒ…çš„ç»“æœã€‚

3\. æ›´æ–° `package.json` æ–‡ä»¶ä¸­çš„ `main` å’Œ `types` å­—æ®µï¼Œä½¿å…¶æŒ‡å‘æ„å»º/ç¼–è¯‘åçš„åŒ…çš„è¾“å‡ºã€‚è¿™æ˜¯ä½œä¸ºé»˜è®¤çš„å¤‡ç”¨é€‰é¡¹ã€‚

```javascript
"types": "./lib/index.d.ts", 
"main": "./lib/index.js",
```

4\. åœ¨ `package.json` æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ª `files` å­—æ®µï¼Œä»¥æŒ‡æ˜åœ¨ npm æ‰“åŒ…ä½ çš„ä»£ç è¿›è¡Œå‘å¸ƒæ—¶åº”åŒ…å«å“ªäº›æ–‡ä»¶ã€‚

```javascript
"files": [ 
  "lib/**/*" 
],
```

5\. é€šè¿‡ `package.json` ä¸­çš„ `scripts` å­—æ®µåˆ›å»ºå‘½ä»¤ï¼Œä»¥ä½¿ç”¨ `tsc` ç¼–è¯‘åŒ…ã€‚è¿™å°†ç”Ÿæˆ `lib` æ–‡ä»¶å¤¹çš„æºæ–‡ä»¶ã€‚

```javascript
"clean": "del-cli ./lib", 
"build": "npm run clean && tsc -p ./tsconfig.json", 
"prepack": "npm run build",
```

- `clean` è„šæœ¬ç”¨äºåˆ é™¤ä¹‹å‰æ„å»ºç”Ÿæˆçš„è¾“å‡ºæ–‡ä»¶ï¼Œä»¥ä¾¿ä»å¤´å¼€å§‹æ„å»ºã€‚

- `build` è„šæœ¬ä¼šæ¸…ç†ä¹‹å‰çš„è¾“å‡ºæ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ TypeScript ç¼–è¯‘å™¨å°†åŒ…æ„å»ºåˆ°è¾“å‡ºç›®å½•ã€‚

- `prepack` è„šæœ¬ç”± npm åœ¨æ‰“åŒ… npm åŒ…ä»¥å‡†å¤‡å‘å¸ƒåˆ°æ³¨å†Œè¡¨ä¹‹å‰ä½¿ç”¨ã€‚

6\. ç°åœ¨ä½ éœ€è¦å®‰è£…æ‰€æœ‰è¿™äº›åŠŸèƒ½æ­£å¸¸å·¥ä½œæ‰€éœ€çš„å¼€å‘ä¾èµ–é¡¹ã€‚è¿è¡Œ `npm install -D typescript del-cli`ã€‚

7\. ç°åœ¨ä½ å¯ä»¥åœ¨ç»ˆç«¯ä¸­è¿è¡Œ `npm run build`ï¼Œè®© TypeScript æ„å»ºä½ çš„é¡¹ç›®ï¼Œä¸ºä½¿ç”¨å’Œå‘å¸ƒåšå‡†å¤‡ã€‚

è¿™å°±æ˜¯ä½¿ç”¨ TypeScript æ„å»ºæ”¯æŒ CommonJS å’Œ ECMAScript æ¨¡å—æ ¼å¼çš„ npm åŒ…æ‰€éœ€çš„æ‰€æœ‰è®¾ç½®ã€‚æ¥ä¸‹æ¥ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•é’ˆå¯¹ npm åŒ…ä»£ç è®¾ç½®å¹¶è¿è¡Œæµ‹è¯•ï¼Œä»¥ç¡®ä¿å®ƒèƒ½äº§ç”Ÿä½ æœŸæœ›çš„ç»“æœã€‚

### è®¾ç½®å¹¶æ·»åŠ æµ‹è¯•

ä¸ºäº†å¯¹ä»£ç çš„è¡Œä¸ºå’Œç»“æœæœ‰ä¿¡å¿ƒï¼Œä½ éœ€è¦å®æ–½ä¸€ä¸ªæµ‹è¯•æµç¨‹ã€‚æµ‹è¯•ä¼šä¿ƒä½¿ä½ åœ¨åˆæ¬¡ç¼–å†™ä»£ç æ—¶ï¼Œä»¥ä¸åŒäºå¸¸è§„é¡ºåˆ©è·¯å¾„çš„æ–¹å¼æ¥æ€è€ƒä»£ç çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æ€è€ƒå¦‚ä½•ç ´åä¸€ä¸ªå‡½æ•°ï¼Œä½¿å…¶æŠ›å‡ºé”™è¯¯æˆ–äº§ç”Ÿéé¢„æœŸçš„ç»“æœã€‚è¿™æ ·åšä¼šè®©ä½ çš„åº”ç”¨ç¨‹åºæ›´å…·å¼¹æ€§å’Œå¯æŒç»­æ€§ï¼ŒåŒæ—¶ç¡®ä¿åœ¨æ·»åŠ æ›´å¤šåŠŸèƒ½æ—¶ä¸ä¼šå‡ºç°é—®é¢˜ã€‚

å¦‚æœä½ æƒ³æ·±å…¥äº†è§£æµ‹è¯•å¹¶å­¦ä¹ å…¶æœ€ä½³å®è·µï¼Œè¯·åŠ¡å¿…é˜…è¯» Yoni Goldberg çš„ [JavaScript æœ€ä½³å®è·µä»“åº“](https://github.com/goldbergyoni/javascript-testing-best-practices)ã€‚

### å•å…ƒæµ‹è¯•

ç¡®ä¿ä½ çš„åŒ…æŒ‰ç…§ä½ æœŸæœ›çš„æ–¹å¼è¿è¡Œï¼Œéœ€è¦é’ˆå¯¹ä½ çš„ä»£ç ç¼–å†™æµ‹è¯•ã€‚ä½ éœ€è¦ä¸€äº›å·¥å…·æ¥å¸®åŠ©è®¾ç½®é¡¹ç›®ä»¥è¿è¡Œå•å…ƒæµ‹è¯•å¹¶æ˜¾ç¤ºç»“æœã€‚è¿™äº›å·¥å…·ç°åœ¨ä½œä¸º Node.js çš„å†…ç½®æ¨¡å—æä¾›ï¼ˆ[è‡ª 20.xã€18.x ç‰ˆæœ¬ä»¥åŠ 16.17.x ç‰ˆæœ¬åœ¨å®éªŒæ ‡å¿—åå¯ç”¨](https://nodejs.org/docs/latest-v22.x/api/test.html#test-runner)ï¼‰ã€‚è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ä¸ºä½ çš„ npm åŒ…è®¾ç½®å¹¶è¿è¡Œæµ‹è¯•ï¼š

1\. åœ¨ç»ˆç«¯ä¸­ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…å¼€å‘ä¾èµ–é¡¹ï¼š`npm i -D @types/node`

2\. åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `tests` æ–‡ä»¶å¤¹ã€‚

3\. åœ¨ `tests` æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª `index.test.ts` æ–‡ä»¶ã€‚

4\. åœ¨ `index.test.ts` æ–‡ä»¶ä¸­ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œä»¥æµ‹è¯• `index.ts` ä¸­çš„ä»£ç ã€‚

**æ³¨æ„**ï¼šä½ å¯ä»¥å‚è€ƒç¤ºä¾‹ npm åŒ…ä»“åº“ä½œä¸ºç¤ºä¾‹ï¼š[https://github.com/snyk-snippets/modern-npm-package](https://github.com/snyk-snippets/modern-npm-package)ã€‚

5\. åœ¨ `package.json` æ–‡ä»¶çš„ `scripts` éƒ¨åˆ†æ·»åŠ ä¸€ä¸ª `test` å±æ€§ï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º `node --experimental-strip-types --test`

```json
{
  "scripts": {
    "clean": "del-cli ./lib",
    "build": "npm run clean && tsc -p ./tsconfig.json",
    "prepack": "npm run build",
    "test": "node --experimental-strip-types --test"
  }
}
```

6\. åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹çš„ç»ˆç«¯ä¸­è¿è¡Œ `npm test` ä»¥æ‰§è¡Œæµ‹è¯•å¹¶æŸ¥çœ‹ç»“æœï¼š

```bash
> @snyk-labs/modern-npm-package@0.0.0-development test 
> node --experimental-strip-types --test 
 
(node:83429) ExperimentalWarning: Type Stripping is an experimental feature and might change at any time 
(Use `node --trace-warnings ...` to show where the warning was created) 
(node:83430) ExperimentalWarning: Type Stripping is an experimental feature and might change at any time 
(Use `node --trace-warnings ...` to show where the warning was created) 
â–¶ NPM Package 
 âœ” should be an object (0.754083ms) 
 âœ” should have a helloWorld property (0.518958ms) 
 âœ” NPM Package (1.754875ms) 
â–¶ Hello World Function 
 âœ” should be a function (0.136667ms) 
 âœ” should return the hello world message (0.063791ms) 
âœ” Hello World Function (0.270417ms) 
â–¶ Goodbye Function 
 âœ” should be a function (0.13275ms) 
 âœ” should return the goodbye message (0.159541ms) 
 âœ” Goodbye Function (0.552542ms) 
â„¹ tests 6 
â„¹ suites 3 
â„¹ pass 6 
â„¹ fail 0 
â„¹ cancelled 0 
â„¹ skipped 0 
â„¹ todo 0 
â„¹ duration_ms 113.692542
```

### åœ¨æµæ°´çº¿ä¸­è¿›è¡Œæµ‹è¯•

æ—¢ç„¶ä½ å·²ç»æœ‰äº†ç”¨äºéªŒè¯ä»£ç è¡Œä¸ºçš„æµ‹è¯•ï¼Œå°±å¯ä»¥åœ¨æµæ°´çº¿ä¸­ä½¿ç”¨å®ƒä»¬äº†ã€‚è¿™å°†æœ‰åŠ©äºç¡®ä¿æ¨é€åˆ°ä»“åº“ä¸­çš„ä»»ä½•æ›´æ”¹éƒ½ä¸ä¼šç ´åä»£ç çš„è¡Œä¸ºã€‚è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤åœ¨é¡¹ç›®æµæ°´çº¿ä¸­åˆ›å»ºä¸€ä¸ªæµ‹è¯•å·¥ä½œæµã€‚

1. ä¸ºä½ çš„ä»“åº“åˆ›å»ºä¸€ä¸ªæ–°çš„ GitHub Actionï¼š`https://github.com/<ä½ çš„è´¦æˆ·æˆ–ç»„ç»‡>/<ä½ çš„ä»“åº“åç§°>/actions/new`

2. å°†å·¥ä½œæµé‡å‘½åä¸º `tests.yml`

3. åœ¨ä½ çš„å·¥ä½œæµæ–‡ä»¶ä¸­æ’å…¥ä»¥ä¸‹ Snyk GitHub Action è„šæœ¬ï¼š

```yml
name: Tests 
 
on: 
 push: 
 branches: [main] 
 pull_request: 
 branches: [main] 
 
jobs: 
 build: 
 
 runs-on: ubuntu-latest 
 
 strategy: 
 matrix: 
 node-version: [22.x] 
 
 steps: 
 - uses: actions/checkout@v4 
 - name: Use Node.js ${{ matrix.node-version }} 
 uses: actions/setup-node@v4 
 with: 
 node-version: ${{ matrix.node-version }} 
 - run: npm ci 
 - run: npm test
```

æ­¤ YAML è„šæœ¬ä¼šæ£€å‡ºä½ æœ€æ–°çš„ä»£ç ï¼Œå®‰è£…å…¶ä¾èµ–é¡¹ï¼Œå¹¶è¿è¡Œ `npm test` å‘½ä»¤æ¥æ‰§è¡Œæµ‹è¯•ã€‚å®ƒä¼šé’ˆå¯¹ `node-version` å­—æ®µä¸­åˆ—å‡ºçš„æ¯ä¸ª Node.js ç‰ˆæœ¬æ‰§è¡Œè¿™äº›æ“ä½œï¼Œè¿™æ ·ä½ å°±å¯ä»¥ç¡®ä¿ä»£ç åœ¨æ¯ä¸ªè¿è¡Œæ—¶ä¸­éƒ½èƒ½æŒ‰é¢„æœŸå·¥ä½œã€‚

ä½ ç°åœ¨å·²ç»å®Œæˆäº†å¯¹ npm åŒ…ä»£ç è¿›è¡Œæµ‹è¯•è¿è¡Œå’Œè¯„ä¼°çš„é¡¹ç›®è®¾ç½®ã€‚ä¸è¿‡ï¼Œä½ å¯èƒ½ä¼šæƒ³ï¼šâ€œæˆ‘å¦‚ä½•åœ¨å¦ä¸€ä¸ªé¡¹ç›®ä¸­ _ä½¿ç”¨_ æˆ‘çš„ npm åŒ…è¿›è¡Œæµ‹è¯•å‘¢ï¼Ÿâ€ æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å®ç°è¿™ä¸€ç‚¹ã€‚

### åŒ…æµ‹è¯•

é€šè¿‡å•å…ƒæµ‹è¯•å¯¹ npm åŒ…çš„ä»£ç æœ‰ä¿¡å¿ƒæ˜¯ä¸€å›äº‹ï¼Œä½†ç¡®ä¿æ•´ä¸ª npm åŒ…çš„ä½¿ç”¨ä½“éªŒåˆæ˜¯å¦ä¸€å›äº‹ã€‚è¿™æ¶‰åŠåˆ°å°†ä½ çš„ npm åŒ…ä½œä¸ºä¾èµ–é¡¹å¼•å…¥åˆ°å¦ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œå¹¶æŸ¥çœ‹å…¶åœ¨è¯¥é¡¹ç›®ä¸­çš„ä½¿ç”¨æ˜¯å¦å¦‚ä½ é¢„æœŸçš„é‚£æ ·é¡ºåˆ©ã€‚ä»¥ä¸‹æ˜¯äº”ç§å¯ä»¥è¿›è¡Œæµ‹è¯•çš„æ–¹æ³•ï¼š

1. é€šè¿‡ `npm pack` è¾“å‡ºè¿›è¡Œå®‰è£…
2. é€šè¿‡ç›¸å¯¹è·¯å¾„è¿›è¡Œå®‰è£…
3. é€šè¿‡ `npm link` è¿›è¡Œå®‰è£…
4. é€šè¿‡æ³¨å†Œè¡¨ï¼ˆä¾‹å¦‚ [npmjs.com](https://npmjs.com/) ä¸Šçš„ npm å…¬å…±æ³¨å†Œè¡¨ï¼‰è¿›è¡Œå®‰è£…
5. ä½¿ç”¨ [Verdaccio](https://verdaccio.org/)ï¼ˆä¸€ä¸ªå¼€æºçš„ npm ç§æœ‰æ³¨å†Œè¡¨é¡¹ç›®ï¼‰åœ¨æŒç»­é›†æˆï¼ˆCIï¼‰ä¸­è¿è¡Œç«¯åˆ°ç«¯çš„åŒ…å‘å¸ƒå’Œå®‰è£…æ­¥éª¤

#### npm pack

è¿™ç§æ–¹æ³•å°†åˆ©ç”¨ `npm pack` å‘½ä»¤å°†ä½ çš„ npm åŒ…æ‰“åŒ…å¹¶å‹ç¼©æˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ï¼ˆ`<åŒ…å>.tgz`ï¼‰ã€‚ç„¶åä½ å¯ä»¥è¿›å…¥æƒ³è¦ä½¿ç”¨è¯¥åŒ…çš„é¡¹ç›®ï¼Œå¹¶é€šè¿‡è¿™ä¸ªæ–‡ä»¶æ¥å®‰è£…å®ƒã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1. åœ¨ä½ çš„ npm åŒ…ç›®å½•ä¸‹ï¼Œåœ¨ç»ˆç«¯ä¸­è¿è¡Œ `npm pack` å‘½ä»¤ã€‚æ³¨æ„å®ƒç”Ÿæˆçš„ `.tgz` æ–‡ä»¶åŠå…¶ä½ç½®ã€‚

2. åˆ‡æ¢åˆ°ä½ æƒ³è¦ä½¿ç”¨ npm åŒ…çš„é¡¹ç›®ç›®å½•ã€‚**ç¤ºä¾‹ï¼š** `cd /path/to/project`

3. åœ¨ **å®¢æˆ·ç«¯** é¡¹ç›®ç›®å½•ä¸­ï¼Œè¿è¡Œ `npm install /path/to/package.tgz`ï¼Œä½†è¦å°† `/path/to/package.tgz` æ›¿æ¢ä¸ºæ­¥éª¤ 1 ä¸­ `.tgz` æ–‡ä»¶çš„æ­£ç¡®è·¯å¾„ã€‚

4. ç„¶åä½ å°±å¯ä»¥åœ¨è¿™ä¸ª **å®¢æˆ·ç«¯** é¡¹ç›®ä¸­å¼€å§‹ä½¿ç”¨è¯¥åŒ…è¿›è¡Œæµ‹è¯•äº†ã€‚

è¿™å°†ä¸ºä½ æä¾›ä½¿ç”¨ npm åŒ…æœ€æ¥è¿‘ç”Ÿäº§ç¯å¢ƒçš„ä½“éªŒã€‚

#### npm link

è¿™ç§æ–¹æ³•å°†åˆ©ç”¨ `npm link` å‘½ä»¤ï¼Œåœ¨å°è¯•å°†ä½ çš„åŒ…å®‰è£…åˆ° **å®¢æˆ·ç«¯** é¡¹ç›®ä¸­æ—¶ï¼ŒæŒ‡å‘ä½ çš„åŒ…ç›®å½•ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1. åœ¨ä½ çš„ npm åŒ…ç›®å½•ä¸‹çš„ç»ˆç«¯ä¸­è¿è¡Œ `npm link`ã€‚

2. åˆ‡æ¢åˆ°ä½ æƒ³è¦ä½¿ç”¨è¯¥ npm åŒ…çš„é¡¹ç›®ç›®å½•ã€‚**ç¤ºä¾‹ï¼š** `cd /path/to/project`

3. åœ¨ **å®¢æˆ·ç«¯** é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ `npm link <ä½ çš„åŒ…å>`ã€‚

è¿™å°†åœ¨ä½ çš„ä»£ç å¼•ç”¨è¯¥åŒ…æ—¶ï¼Œå°† **å®¢æˆ·ç«¯** é¡¹ç›®æŒ‡å‘ npm åŒ…ç›®å½•ã€‚è¿™ç§æ–¹æ³•ä¸ä¼šç»™ä½ æä¾›å®Œå…¨ç±»ä¼¼äºç”Ÿäº§ç¯å¢ƒçš„åŒ…ä½¿ç”¨ä½“éªŒï¼Œä½†å¯ä»¥ç¡®ä¿åŒ…çš„åŠŸèƒ½æŒ‰é¢„æœŸå·¥ä½œã€‚

#### ç›¸å¯¹è·¯å¾„

è¿™ç§æ–¹æ³•åˆ©ç”¨äº†ä½ ç°æœ‰çš„ `npm install` å‘½ä»¤ä½¿ç”¨çŸ¥è¯†ã€‚å®ƒç±»ä¼¼äº `npm link`ï¼Œä½†æ— éœ€å­¦ä¹ åƒ `link` è¿™æ ·çš„æ–°å‘½ä»¤ã€‚

1. åœ¨ä½ çš„ **å®¢æˆ·ç«¯** é¡¹ç›®ç›®å½•ä¸‹çš„ç»ˆç«¯ä¸­è¿è¡Œ `npm install /path/to/your/package`ã€‚

ä¸ `npm link` æ–¹æ³•ç±»ä¼¼ï¼Œè¿™èƒ½è®©ä½ åœ¨å®¢æˆ·ç«¯é¡¹ç›®ä¸­å¿«é€Ÿæµ‹è¯•åŒ…çš„åŠŸèƒ½ï¼Œä½†æ— æ³•æä¾›å®Œå…¨ç±»ä¼¼ç”Ÿäº§ç¯å¢ƒçš„ä½“éªŒã€‚è¿™æ˜¯å› ä¸ºå®ƒæŒ‡å‘çš„æ˜¯å®Œæ•´çš„åŒ…æºä»£ç ç›®å½•ï¼Œè€Œ **ä¸æ˜¯** ä½ åœ¨ npm æ³¨å†Œè¡¨ä¸­èƒ½æ‰¾åˆ°çš„æ‰“åŒ…ç‰ˆæœ¬ã€‚

#### npm æ³¨å†Œè¡¨

è¿™ç§æ–¹æ³•åˆ©ç”¨äº† npm åŒ…çš„å…¬å…±ï¼ˆæˆ–ä½ è‡ªå·±çš„ï¼‰æ³¨å†Œè¡¨ã€‚å®ƒæ¶‰åŠå‘å¸ƒä½ çš„åŒ…ï¼Œå¹¶åƒå®‰è£…å…¶ä»–ä»»ä½• npm åŒ…ä¸€æ ·è¿›è¡Œå®‰è£…ã€‚

1. ä½¿ç”¨æœ¬æ–‡å‰é¢æ¦‚è¿°çš„æ­¥éª¤ï¼Œé€šè¿‡ `npm publish` å‘½ä»¤å‘å¸ƒä½ çš„ npm åŒ…ã€‚

2. åˆ‡æ¢åˆ°ä½ æƒ³è¦ä½¿ç”¨è¯¥ npm åŒ…çš„é¡¹ç›®ç›®å½•ã€‚**ç¤ºä¾‹ï¼š** `cd /path/to/project`

3. åœ¨ **å®¢æˆ·ç«¯** é¡¹ç›®ç›®å½•ä¸­è¿è¡Œ `npm install <name-of-your-package>`ã€‚
Shout out to Mirco Kraenz ([@MKraenz](https://twitter.com/MKraenz)) who created a [Twitter thread](https://twitter.com/MKraenz/status/1559188177696436226?s=20&t=LJg1FbyDLTmiOGAUQh7LmQ) summarizing our learnings of this during a livestream!

æ­¤æ—¶ï¼Œä½ å·²ç»æ„å»ºäº†æ”¯æŒç°ä»£æ¨¡å—æ ¼å¼çš„åŒ…ï¼Œå¹¶é€šè¿‡å•å…ƒæµ‹è¯•å’Œæ‰“åŒ…æµ‹è¯•ç¡®ä¿å®ƒèƒ½æŒ‰é¢„æœŸè¿è¡Œã€‚æ¥ä¸‹æ¥ï¼Œä½ éœ€è¦ç¡®ä¿ npm åŒ…ä¸­ä¸å­˜åœ¨å®‰å…¨é—®é¢˜ï¼Œå¹¶é˜²æ­¢å¼•å…¥æ–°çš„å®‰å…¨é—®é¢˜ã€‚

## å®æ–½å®‰å…¨æ£€æŸ¥

å°±åƒä½ ä¸å¸Œæœ›è‡ªå·±çš„é¡¹ç›®å­˜åœ¨å®‰å…¨æ¼æ´ä¸€æ ·ï¼Œä½ ä¹Ÿä¸å¸Œæœ›å°†æ¼æ´å¼•å…¥åˆ°å…¶ä»–äººçš„é¡¹ç›®ä¸­ã€‚æ„å»ºä¸€ä¸ªé¢„è®¡ä¼šåœ¨è®¸å¤šå…¶ä»–é¡¹ç›®ä¸­ä½¿ç”¨çš„ npm åŒ…ï¼Œæ„å‘³ç€ä½ éœ€è¦æ‰¿æ‹…æ›´å¤§çš„è´£ä»»æ¥ç¡®ä¿ä¸€åˆ‡éƒ½æ˜¯å®‰å…¨çš„ã€‚ä½ éœ€è¦è®¾ç½®å®‰å…¨æ£€æŸ¥ï¼Œä»¥å¸®åŠ©ç›‘æ§æ¼æ´ã€å‘å‡ºè­¦æŠ¥å¹¶æä¾›ç¼“è§£æ¼æ´çš„ååŠ©ã€‚åƒ [Snyk](https://snyk.io/product/) è¿™æ ·çš„å·¥å…·å°±å¯ä»¥ç®€åŒ–å®ç°è¿™äº›éœ€æ±‚æ‰€éœ€çš„å·¥ä½œã€‚

å¯¹äºè¿™ä¸ªç¤ºä¾‹ npm åŒ…ï¼Œä½ ä½¿ç”¨ GitHub ä½œä¸ºæºä»£ç ç®¡ç†å·¥å…·ï¼Œå› æ­¤ä½ å¯ä»¥åˆ©ç”¨å…¶ GitHub Actions åŠŸèƒ½å°† Snyk é›†æˆåˆ°ä½ çš„å·¥ä½œæµç¨‹ä¸­ã€‚Snyk æœ‰ä¸€ä¸ª [GitHub Actions](https://github.com/snyk/actions) å‚è€ƒé¡¹ç›®ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿå¯åŠ¨è¿™é¡¹å·¥ä½œï¼Œå¹¶ä¸ºä½ å¯èƒ½åœ¨é¡¹ç›®ä¸­ä½¿ç”¨çš„å…¶ä»–ç¼–ç¨‹è¯­è¨€å’Œå·¥å…·æä¾›ç¤ºä¾‹ã€‚

1. Snyk æ˜¯å…è´¹çš„ï¼Œå› æ­¤è¯·æ³¨å†Œå¹¶è·å–ä½ çš„ [Snyk API ä»¤ç‰Œ](https://app.snyk.io/account)ã€‚

2. åœ¨ GitHub ä¸Šå°†ä½ çš„ Snyk API ä»¤ç‰Œæ·»åŠ ä¸ºä»“åº“å¯†é’¥ï¼š`https://github.com/<ä½ çš„è´¦æˆ·æˆ–ç»„ç»‡>/<ä½ çš„ä»“åº“åç§°>/settings/secrets/actions/new`

3. ä¸ºä½ çš„ä»“åº“åˆ›å»ºä¸€ä¸ªæ–°çš„ GitHub Actionï¼š`https://github.com/<ä½ çš„è´¦æˆ·æˆ–ç»„ç»‡>/<ä½ çš„ä»“åº“åç§°>/actions/new`

4. å°†å·¥ä½œæµé‡å‘½åä¸º `snyk.yml`ã€‚

5. åœ¨ä½ çš„å·¥ä½œæµæ–‡ä»¶ä¸­æ’å…¥ä»¥ä¸‹ Snyk Action è„šæœ¬ï¼š

```yml
name: Snyk Security Check 
on: [push,pull_request] 
jobs: 
 security: 
 runs-on: ubuntu-latest 
 steps: 
 - uses: actions/checkout@main 
 - name: Run Snyk to check for vulnerabilities 
 uses: snyk/actions/node@master 
 env: 
 SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
```

6\. æäº¤ä½ çš„æ›´æ”¹ã€‚

7\. éªŒè¯æ“ä½œæ˜¯å¦æˆåŠŸè¿è¡Œï¼š`https://github.com/<ä½ çš„è´¦æˆ·æˆ–ç»„ç»‡>/<ä½ çš„ä»“åº“åç§°>/actions`

è®¾ç½®å®Œæˆåï¼Œ**æ¯å½“æœ‰äººå‘ä½ çš„ä»“åº“æ¨é€ä»£ç æˆ–æ‰“å¼€æ‹‰å–è¯·æ±‚æ—¶ï¼Œéƒ½ä¼šè¿è¡Œå®‰å…¨æ£€æŸ¥**ï¼Œä»¥ç¡®ä¿ä¸ä¼šå‘åŒ…ä¸­å¼•å…¥ä»»ä½•æ¼æ´ã€‚å¦‚æœå‘ç°é—®é¢˜ï¼Œæ“ä½œå°†å¤±è´¥ï¼Œå¹¶å‘ä½ å‘å‡ºæ‰¾åˆ°çš„å®‰å…¨é—®é¢˜çš„è¯¦ç»†ä¿¡æ¯è­¦æŠ¥ã€‚æ¥ä¸‹æ¥ï¼Œä½ å°†è‡ªåŠ¨åŒ– npm åŒ…çš„ç‰ˆæœ¬ç®¡ç†å’Œå‘å¸ƒè¿‡ç¨‹ã€‚

ä½ æ˜¯å¦æƒ³åœ¨æ›´æ”¹æ¨é€åˆ°ä»“åº“ä¹‹å‰å°±äº†è§£å®‰å…¨é—®é¢˜ï¼Ÿ[ä¸ºä½ é€‰æ‹©çš„å¼€å‘å·¥å…·å®‰è£… Snyk æ’ä»¶](https://snyk.io/platform/ide-plugins/)ã€‚ä½ æ›´å–œæ¬¢ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·å—ï¼Ÿ[ä¹Ÿå°† Snyk å‘½ä»¤è¡Œå·¥å…·æ·»åŠ åˆ°ä½ çš„å·¥å…·é“¾ä¸­](https://snyk.io/platform/snyk-cli/)ã€‚è¿™äº›å·¥å…·å°†å¸®åŠ©ä½ åœ¨å¼€å‘è¿‡ç¨‹ä¸­æ£€æµ‹å®‰å…¨é—®é¢˜ï¼Œå¹¶åœ¨é¡¹ç›®å·¥ä½œæµç¨‹çš„æ—©æœŸå‘ä½ å‘å‡ºè­¦æŠ¥ã€‚

å…³äºå½“å‰è®¾ç½®éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå®ƒä»…åˆ©ç”¨äº† [Snyk å¼€æº](https://snyk.io/product/open-source-security-management/)ï¼ˆSCAï¼‰äº§å“ï¼Œè€Œæ²¡æœ‰ä½¿ç”¨ [Snyk ä»£ç ](https://snyk.io/product/snyk-code/)ï¼ˆSASTï¼‰ã€‚Snyk ä»£ç æ˜¯æˆ‘ä»¬çš„ä»£ç å®‰å…¨äº§å“ï¼Œä½ éœ€è¦å…ˆé€šè¿‡ Snyk è´¦æˆ·å…è´¹å¯ç”¨å®ƒï¼Œç„¶åå°†å…¶æ·»åŠ åˆ°æ­¤å¤„çš„å·¥ä½œæµè„šæœ¬ä¸­ï¼Œä»¥å……åˆ†åˆ©ç”¨å®ƒã€‚è¦äº†è§£æ›´å¤šå…³äºåœ¨ç®¡é“ä¸­ä½¿ç”¨ Snyk ä»£ç çš„ä¿¡æ¯ï¼Œè¯·é˜…è¯»è¿™ç¯‡å…³äº [ä½¿ç”¨ GitHub Actions æ„å»ºå®‰å…¨ç®¡é“](https://snyk.io/blog/building-a-secure-pipeline-with-github-actions/) çš„æ–‡ç« ï¼ˆè¯¥æ–‡ç« ä½¿ç”¨ Java å’Œ Mavenï¼Œä½†å¯ä»¥æ›¿æ¢ä¸º Node.js å’Œ npmï¼‰ã€‚

## è‡ªåŠ¨åŒ–ç‰ˆæœ¬ç®¡ç†å’Œå‘å¸ƒ

æ¯å½“ä½ å°†æ›´æ”¹åˆå¹¶åˆ°ä¸»åˆ†æ”¯æ—¶ï¼Œä½ å¯èƒ½ä¸æƒ³æ¯æ¬¡éƒ½æ‰‹åŠ¨æ›´æ–° npm åŒ…çš„ç‰ˆæœ¬å¹¶å‘å¸ƒå®ƒã€‚ç›¸åï¼Œä½ ä¼šå¸Œæœ›å°†è¿™ä¸ªè¿‡ç¨‹è‡ªåŠ¨åŒ–ã€‚å¦‚æœä½ è¿˜è®°å¾—æœ¬æ–‡å‰é¢ç®€å• npm åŒ…çš„ç¤ºä¾‹ï¼Œä½ ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å‘å¸ƒ npm åŒ…ï¼š

ä½ è¿˜å¸Œæœ›éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶çš„è¡Œä¸šæ ‡å‡†ï¼Œè¿™æ ·ä½ çš„åŒ…çš„ä½¿ç”¨è€…å°±èƒ½ç†è§£ä½ å‘å¸ƒåˆ°æ³¨å†Œè¡¨çš„ä¸åŒç‰ˆæœ¬å˜æ›´ä¼šå¸¦æ¥ä»€ä¹ˆå½±å“ã€‚

### ä»€ä¹ˆæ˜¯è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ï¼Ÿ

è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶è§„å®šç‰ˆæœ¬å·ç”±ä¸‰ä¸ªå ä½ç¬¦ç»„æˆã€‚ç¬¬ä¸€ä¸ªæ˜¯ä¸»ç‰ˆæœ¬å·ï¼Œç¬¬äºŒä¸ªæ˜¯æ¬¡ç‰ˆæœ¬å·ï¼Œæœ€åä¸€ä¸ªæ˜¯è¡¥ä¸ç‰ˆæœ¬å·ã€‚è¦äº†è§£æ›´å¤šå…³äºè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ã€ç‰ˆæœ¬ç®¡ç†å’Œé”æ–‡ä»¶çš„ä¿¡æ¯ï¼Œè¯·é˜…è¯»[ä»€ä¹ˆæ˜¯ Package Lock JSON ä»¥åŠé”æ–‡ä»¶å¦‚ä½•ä¸ Yarn å’Œ NPM åŒ…ä¸€èµ·å·¥ä½œ](https://snyk.io/blog/what-is-package-lock-json/)ã€‚

å¦‚æœä½ å¯ä»¥è·³è¿‡æ‰€æœ‰æ‰‹åŠ¨æ“ä½œï¼Œè€Œæ˜¯ä½¿ç”¨ GitHub Actions è®¾ç½®ä¸€ä¸ªè‡ªåŠ¨åŒ–å·¥ä½œæµæ¥ä¸ºä½ å¤„ç† npm åŒ…çš„å‘å¸ƒï¼Œä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿä½ å¾ˆå¹¸è¿ï¼Œå› ä¸ºæœ‰ä¸€ä¸ªåä¸º [Semantic Release](https://semantic-release.gitbook.io/semantic-release/) çš„å·¥å…·ï¼Œå®ƒå¯ä»¥ä¸ [GitHub Actions](https://semantic-release.gitbook.io/semantic-release/recipes/ci-configurations/github-actions) é›†æˆã€‚å¸®åŠ©è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹çš„å…³é”®æ˜¯ï¼Œåœ¨å‘é¡¹ç›®æäº¤æ›´æ”¹æ—¶ä½¿ç”¨æ‰€è°“çš„ [å¸¸è§„æäº¤](https://www.conventionalcommits.org/en/v1.0.0/)ã€‚è¿™ä½¿å¾—è‡ªåŠ¨åŒ–å¯ä»¥ç›¸åº”åœ°æ›´æ–°æ‰€æœ‰å†…å®¹ï¼Œå¹¶çŸ¥é“å¦‚ä½•ä¸ºä½ å‡†å¤‡é¡¹ç›®çš„ä¸‹ä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒã€‚

ä»¥ä¸‹æ­¥éª¤å°†æŒ‡å¯¼ä½ ä¸ºç°ä»£ npm åŒ…è®¾ç½®è¿™ä¸ªåŠŸèƒ½ã€‚

1. åœ¨ç»ˆç«¯ä¸­è¿è¡Œï¼š`npm i -D semantic-release`

2. åœ¨ç»ˆç«¯ä¸­è¿è¡Œï¼š`npx semantic-release-cli setup`

3. æŒ‰ç…§ç»ˆç«¯æç¤ºå¹¶æä¾›æ‰€éœ€çš„ä»¤ç‰Œï¼š

- ä½ éœ€è¦ä¸€ä¸ªæ¥è‡ª GitHub çš„ä¸ªäººè®¿é—®ä»¤ç‰Œã€‚è¦åˆ›å»ºä¸€ä¸ªä»¤ç‰Œï¼Œè¯·è®¿é—® `https://github.com/settings/tokens/new?scopes=public_repo`

- åˆ›å»ºæ­¤ä»¤ç‰Œæ—¶ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹æƒé™èŒƒå›´ï¼š

![ ](https://res.cloudinary.com/snyk/image/upload/f_auto,w_2560,q_auto/v1663712555/wordpress-sync/blog-create-npm-packages-new-token.png)

- ç‚¹å‡» â€œç”Ÿæˆä»¤ç‰Œâ€ æŒ‰é’®ï¼Œå¹¶å¤åˆ¶å¹¶ä¿å­˜é¡µé¢ä¸Šæ˜¾ç¤ºçš„å€¼ã€‚

- ä½ è¿˜éœ€è¦ä¸€ä¸ªæ¥è‡ª npm çš„ **è‡ªåŠ¨åŒ–ç±»å‹** è®¿é—®ä»¤ç‰Œï¼Œä»…ç”¨äº CI ç¯å¢ƒï¼Œä»¥ä¾¿å®ƒèƒ½å¤Ÿç»•è¿‡ä½ è´¦æˆ·çš„åŒå› ç´ èº«ä»½éªŒè¯ï¼ˆ2FAï¼‰ã€‚è¦åˆ›å»ºä¸€ä¸ªè¿™æ ·çš„ä»¤ç‰Œï¼Œè¯·è®¿é—® `https://www.npmjs.com/settings/<your-npm-account>/tokens`ã€‚è¯·ç¡®ä¿é€‰æ‹© â€œAutomationâ€ ç±»å‹ï¼Œå› ä¸ºè¿™å°†åœ¨ CI/CD å·¥ä½œæµä¸­ä½¿ç”¨ã€‚

![ ](https://res.cloudinary.com/snyk/image/upload/f_auto,w_2560,q_auto/v1663712548/wordpress-sync/blog-create-npm-packages-token.png)

```bash
bc@mbp-snyk modern-npm-package % npx semantic-release-cli setup 
? What is your npm registry? https://registry.npmjs.org/ 
? What is vour nom username? clarkio 
? What is your pm password? [hidden] 
? What is your NPM two-factor authentication code? <2FA code> 
Provide a GitHub Personal Access Token (create a token at https://github.com/settings/tokens/new?scopes=repo <token> 
? What CI are you using? Github Actions 
bc@mbp-snyk modern-npm-package %
```

4\. åœ¨æ­¤å¤„å°†ä½ çš„ npm ä»¤ç‰Œä½œä¸ºä»“åº“å¯†é’¥æ·»åŠ åˆ° GitHub ä»“åº“ä¸­ï¼š`https://github.com/<ä½ çš„åç§°æˆ–ç»„ç»‡>/<ä½ çš„ä»“åº“>/settings/secrets/actions/new`ã€‚å°†å¯†é’¥åç§°è®¾ç½®ä¸º `NPM_TOKEN`ï¼Œå€¼ä¸ºä½ åœ¨å‰é¢æ­¥éª¤ä¸­è·å–çš„ä»¤ç‰Œã€‚

![ ](https://res.cloudinary.com/snyk/image/upload/f_auto,w_2560,q_auto/v1663712560/wordpress-sync/blog-create-npm-packages-secret.png)

5\. å›åˆ°ä½ çš„é¡¹ç›®ï¼Œæ‰“å¼€ `package.json` æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹æ‰€ç¤ºçš„ `releases` é”®ã€‚å¦‚æœä½ çš„ä»“åº“ä¸»åˆ†æ”¯ä»ç„¶åä¸º `master` è€Œä¸æ˜¯ `main`ï¼Œåˆ™ç›¸åº”åœ°æ›´æ–°ä¸Šè¿° `branches` çš„å€¼ã€‚

```javascript
"release": { 
  "branches": ["main"] 
}
```

6\. åŒæ—¶åœ¨ `package.json` æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ª `publishConfig` é”®ï¼š

```javascript
"publishConfig": {  
  "access": "public"  
}
```

7\. ä½¿ç”¨ `semantic-release` npm è„šæœ¬è¿›è¡Œè¯•è¿è¡Œæ¥æµ‹è¯•æ‰€æœ‰å†…å®¹ã€‚è·å–ä»¥ä¸‹å‘½ä»¤ï¼Œå¹¶å°† `NPM_TOKEN=` å’Œ `GH_TOKEN=` çš„å€¼è®¾ç½®ä¸ºä½ å„è‡ªçš„ä»¤ç‰Œå€¼ã€‚ç„¶åå¤åˆ¶å®Œæ•´å‘½ä»¤å¹¶åœ¨ç»ˆç«¯ä¸­è¿è¡Œï¼ŒæŸ¥çœ‹ä¸€åˆ‡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚ä½ å°†åœ¨ç»ˆç«¯è¾“å‡ºä¸­çœ‹åˆ°è¯¥è¿‡ç¨‹çš„æ—¥å¿—ã€‚å¦‚æœå‡ºç°ä»»ä½•é—®é¢˜ï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºç›¸å…³ä¿¡æ¯ï¼Œå¹¶æä¾›è§£å†³é—®é¢˜çš„è¯¦ç»†è¯´æ˜ã€‚

8\. ç¡®è®¤è¯•è¿è¡ŒæˆåŠŸå®Œæˆåï¼Œä½ å¯ä»¥ä¸º GitHub ä»“åº“è®¾ç½®ä¸€ä¸ªæ–°çš„ GitHub Action æ¥ä¸ºä½ å¤„ç†å‘å¸ƒè¿‡ç¨‹ã€‚å‰å¾€ GitHub ä¸Šçš„ä»“åº“ï¼Œç‚¹å‡» â€œActionsâ€ã€‚

9\. ç‚¹å‡» **æ–°å»ºå·¥ä½œæµ** é€‰é¡¹ã€‚

10\. å°†å·¥ä½œæµé‡å‘½åä¸º `release.yml`ã€‚

11\. å°†ä»¥ä¸‹ YAML è„šæœ¬æ·»åŠ åˆ°æ–°çš„å·¥ä½œæµæ–‡ä»¶ä¸­ã€‚è¯¥è„šæœ¬æœ¬è´¨ä¸Šæ˜¯è¯´ï¼Œä¸€æ—¦ Snyk å®‰å…¨æ£€æŸ¥å·¥ä½œæˆåŠŸå®Œæˆï¼Œå°±è¿è¡Œå‘å¸ƒä½œä¸šã€‚å‘å¸ƒä½œä¸šä¼šæ£€å‡ºä»£ç ï¼Œè®¾ç½® Node.js ç¯å¢ƒï¼Œå®‰è£…ä¾èµ–é¡¹ï¼Œç„¶åä½¿ç”¨ä½ çš„ GitHub å’Œ npm ä»¤ç‰Œè¿è¡Œè¯­ä¹‰åŒ–å‘å¸ƒã€‚

```javascript
name: Release 
on: 
 workflow_run: 
 workflows: ['Snyk Security Check', 'Tests'] 
 branches: [main] 
 types: 
 - completed 
 
permissions: 
 contents: read 
 
jobs: 
 release: 
 name: Release 
 runs-on: ubuntu-latest 
 permissions: 
 contents: write # to be able to publish a GitHub release 
 issues: write # to be able to comment on released issues 
 pull-requests: write # to be able to comment on released pull requests 
 id-token: write 
 steps: 
 - name: Checkout 
 uses: actions/checkout@v4 
 with: 
 fetch-depth: 0 
 - name: Setup Node.js 
 uses: actions/setup-node@v4 
 with: 
 node-version: 'lts/*' 
 - name: Install dependencies 
 run: npm ci 
 - name: Verify the integrity of provenance attestations and registry signatures for installed dependencies 
 run: npm audit signatures 
 - name: Release 
 env: 
 GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} 
 NPM_TOKEN: ${{ secrets.NPM_TOKEN }} 
 run: npx semantic-release
```

è¿™ä¸ªè„šæœ¬æœ¬è´¨ä¸Šè¡¨æ˜ï¼Œä¸€æ—¦ Snyk å®‰å…¨æ£€æŸ¥å’Œæµ‹è¯•å·¥ä½œæˆåŠŸå®Œæˆï¼Œå°±è¿è¡Œå‘å¸ƒä½œä¸šã€‚å‘å¸ƒä½œä¸šä¼šæ£€å‡ºä»£ç ï¼Œè®¾ç½® Node.js ç¯å¢ƒï¼Œå®‰è£…ä¾èµ–é¡¹ï¼Œç„¶åä½¿ç”¨ä½ çš„ GitHub å’Œ npm ä»¤ç‰Œè¿è¡Œè¯­ä¹‰åŒ–å‘å¸ƒã€‚

- æ³¨æ„ï¼šGitHub Actions å†…ç½®äº† GITHUB_TOKEN å¯†é’¥/ç¯å¢ƒå˜é‡ï¼Œå› æ­¤åœ¨è¿™ä¸ªç¯å¢ƒä¸­æ— éœ€æä¾›ä¸ªäººè®¿é—®ä»¤ç‰Œã€‚ä¸ªäººè®¿é—®ä»¤ç‰Œä»…ç”¨äºå¯¹è¯­ä¹‰åŒ–å‘å¸ƒé…ç½®è¿›è¡Œæœ¬åœ°æµ‹è¯•ã€‚

12\. æäº¤æœ¬åœ°æ›´æ”¹å¹¶å°†å…¶æ¨é€åˆ°ä½ çš„ GitHub ä»“åº“

- ä½ å¯ä»¥åœ¨ç»ˆç«¯ä¸­è¿è¡Œå‘½ä»¤ `git commit -am '<ä½ çš„æäº¤æ¶ˆæ¯>'`ï¼Œç„¶åè¿è¡Œ `git push` æ¥å®Œæˆæ­¤æ“ä½œã€‚

- ä½ ä¹Ÿå¯ä»¥é€šè¿‡ VS Code çš„[ç‰ˆæœ¬æ§åˆ¶åŠŸèƒ½](https://code.visualstudio.com/docs/editor/versioncontrol)æ¥å®Œæˆã€‚

13\. è®¾ç½®å¥½æ‰€æœ‰è¿™äº›ä¹‹åï¼Œä½ ç°åœ¨å¯ä»¥ä½¿ç”¨[è§„èŒƒæäº¤](https://www.conventionalcommits.org/en/v1.0.0/)å°†æ›´æ”¹æ¨é€åˆ°ä¸»åˆ†æ”¯ï¼ˆæˆ–è€…é€šè¿‡åˆå¹¶æ‹‰å–è¯·æ±‚ï¼‰ï¼Œå¹¶ä¸”å‘å¸ƒå·¥ä½œæµå°†è¿è¡Œï¼ˆå½“ç„¶æ˜¯åœ¨ Snyk å®‰å…¨æ£€æŸ¥ä¹‹åï¼‰ã€‚ä½ å¯ä»¥åœ¨ç¤ºä¾‹[ç°ä»£ npm åŒ…ä»“åº“å·¥ä½œæµ](https://github.com/snyk-snippets/modern-npm-package/actions/runs/13039904020)ä¸­æŸ¥çœ‹è¿™ä¸€è¿‡ç¨‹çš„å®ä¾‹ã€‚

## é€šè¿‡ GitHub ä½¿ç”¨ Snyk è¿›è¡ŒæŒç»­å®‰å…¨ç›‘æ§

è™½ç„¶åœ¨æäº¤ä»£ç çš„è¿‡ç¨‹ä¸­ç›´æ¥è¿›è¡Œå®‰å…¨æ£€æŸ¥å¾ˆæœ‰å¥½å¤„ï¼Œä½†ä»æœ‰å¯èƒ½é”™è¿‡ä¸¤æ¬¡æäº¤ä¹‹é—´å‡ºç°çš„æ¼æ´ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å‡ ä¸ªæœˆéƒ½æ²¡æœ‰å‘ä»“åº“æ¨é€ä»»ä½•ä»£ç ï¼Œé‚£ä¹ˆåœ¨è¿™æ®µæ—¶é—´å†…å‘ç°çš„ä»»ä½•æ–°æ¼æ´ä½ éƒ½ä¸ä¼šçŸ¥æ™“ã€‚è¿™æ—¶ï¼ŒSnyk å°±èƒ½å‘æŒ¥æ›´å¤§çš„ä½œç”¨ï¼å½“ä½ å°† GitHub ä»“åº“è¿æ¥åˆ° Snyk æ—¶ï¼Œæ— è®ºä½ å¤šä¹…åœ¨é¡¹ç›®ä¸Šç¼–å†™ä¸€æ¬¡ä»£ç ï¼Œå®ƒéƒ½ä¼šè‡ªåŠ¨ç›‘æ§æ–°çš„æ¼æ´å¹¶å‘ä½ å‘å‡ºè­¦æŠ¥ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜ä¼šè‡ªåŠ¨åˆ›å»ºæ‹‰å–è¯·æ±‚æ¥å¸®ä½ è§£å†³å®‰å…¨é—®é¢˜ã€‚

Snyk æœ‰ä¸¤æ¬¾äº§å“å¯¹ç¡®ä¿ npm åŒ…ä»£ç åŠå…¶ä¾èµ–é¡¹çš„å®‰å…¨æ€§ç‰¹åˆ«æœ‰å¸®åŠ©ã€‚[Snyk Code](https://snyk.io/product/snyk-code/) æœ‰åŠ©äºä¿éšœä½ çš„åŒ…ä»£ç å®‰å…¨ï¼Œ[Snyk Open Source](https://snyk.io/product/open-source-security-management/) åˆ™ä¼šç›‘æ§ä½ çš„å¼€æºä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

è¦å……åˆ†åˆ©ç”¨ä½ çš„å…è´¹ Snyk è´¦æˆ·ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

1\. [ç™»å½•ä½ çš„å…è´¹ Snyk è´¦æˆ·](https://app.snyk.io/login)

2\. é€‰æ‹© **æ·»åŠ é¡¹ç›®**ï¼Œç„¶åé€‰æ‹© **GitHub**ã€‚

![ ](https://res.cloudinary.com/snyk/image/upload/f_auto,w_2560,q_auto/v1663712563/wordpress-sync/blog-create-npm-packages-gh.png)

3\. æŒ‰åç§°æœç´¢ä½ çš„é¡¹ç›®ä»“åº“ï¼Œå¹¶é€‰ä¸­å…¶æ—è¾¹çš„å¤é€‰æ¡†ã€‚

![ ](https://res.cloudinary.com/snyk/image/upload/f_auto,w_2560,q_auto/v1663712557/wordpress-sync/blog-create-npm-packages-snyk.png)

4\. ç¡®è®¤ä»“åº“å·²æˆåŠŸå¯¼å…¥ Snykã€‚

![ ](https://res.cloudinary.com/snyk/image/upload/f_auto,w_2560,q_auto/v1663712563/wordpress-sync/blog-create-npm-packages-project.png)

## å¼€å§‹åˆ›å»ºç°ä»£ npm åŒ…

è®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹ä½ åœ¨æœ¬æ–‡ä¸­å­¦åˆ°çš„æ‰€æœ‰å†…å®¹ã€‚é¦–å…ˆï¼Œä½ äº†è§£äº†å¦‚ä½•è®¾ç½®ã€åˆ›å»ºå’Œéƒ¨ç½²ä¸€ä¸ªç®€å•çš„ npm åŒ…ã€‚è¿™å¯¹äºé¦–æ¬¡ç†Ÿæ‚‰å¦‚ä½•å‘å¸ƒè‡ªå·±çš„ npm åŒ…éå¸¸æœ‰å¸®åŠ©ã€‚ç„¶è€Œï¼Œå¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªå¯ç”¨äºç”Ÿäº§ç¯å¢ƒçš„ npm åŒ…ï¼Œä»¥è¿™ç§æ–¹å¼æ“ä½œä¼šéå¸¸ç¹çä¸”éš¾ä»¥æŒç»­ã€‚

ä¸ºäº†åˆ›å»ºä¸€ä¸ªå¯ç”¨äºç”Ÿäº§ç¯å¢ƒçš„åŒ…ï¼Œä½ éšåå­¦ä¹ äº†å¦‚ä½•ä¸º CommonJS (CJS) å’Œ ECMAScript (ESM) æ¨¡å—æ ¼å¼è¿›è¡Œæ„å»ºï¼Œå¦‚ä½•è®¾ç½®å¹¶ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œå¦‚ä½•å®æ–½å®‰å…¨æ£€æŸ¥ä»¥åŠå¦‚ä½•è‡ªåŠ¨åŒ–ç‰ˆæœ¬ç®¡ç†å’Œå‘å¸ƒã€‚æœ‰äº†è¿™äº›çŸ¥è¯†ï¼Œä½ ç°åœ¨å·²ç»å‡†å¤‡å¥½åˆ›å»ºæ›´å¤šæ˜“äºç¤¾åŒºæˆ–å…¬å¸ä½¿ç”¨çš„ npm åŒ…äº†ã€‚

è¯•è¯• Snyk å…è´¹çš„ [JavaScript ä»£ç æ£€æŸ¥å™¨](https://snyk.io/code-checker/javascript/)ï¼Œä»¥æŸ¥æ‰¾å¹¶ä¿®å¤ä»£ç ä¸­çš„æ¼æ´ã€‚

[åŸæ–‡](https://snyk.io/blog/best-practices-create-modern-npm-package/)
